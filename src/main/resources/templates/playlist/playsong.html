<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">


<head>
    <title>내플리스 MyPlaylists</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-latest.js"></script>
</head>

<body>
    <header>
        <div class="mac-btn" id="mac-btn1"></div>
        <div class="mac-btn" id="mac-btn2"></div>
        <div class="mac-btn" id="mac-btn3"></div>
    </header>

    <div class="container clearfix">
        <div class="people-list" id="people-list">
            <div class="search">
            	<form method="get" action="/mylist/search">
            		<input type="text" placeholder="플레이리스트 검색" name="keyword">
            	</form>
            </div>
            <div class="menu-btn">
            	<a class="add-btn" th:href="@{/mylist}">뒤로</a>
            </div>
            
            <ul class="list">
                <li class="clearfix" th:each="song:${songs}">
                    <a th:href="@{'/mylist/'+${playlist.id}+'/'+${song.id}}">
                        <div class="about">
                            <div class="name" th:text="${song.title}">노래 제목</div>
                            <div class="status" th:text="${#temporals.format(song.createdAt,'yy-MM-dd HH:mm')}"></div>
                        </div>
                    </a>
                </li>
            </ul>
            <div class="pagination">
	           	<a class="logout-btn" th:href="@{/logout}">로그아웃</a>
	         
            </div>
        </div>

        <div class="chat">
            <div class="chat-header clearfix">
                <div class="chat-about">
                    <div class="chat-with" th:text="${playlist.title}">해당 플레이리스트 제목</div>
                    <div class="chat-num-messages" th:text=${playlist.description}>해당 플레이리스트 설명(20자 이내)</div>
                </div>
                <a th:href="@{'/mylist/'+${playlist.id} + '/add'}"><i class="fa fa-plus"></i></a>
            </div>
            <!-- end chat-header -->

            <div class="chat-history">
            	<div id="player"></div>
            </div>
        </div>
    </div>
    <!-- end container -->
	<script th:inline="javascript">
		/*<![CDATA[*/
        // 2. This code loads the IFrame Player API code asynchronously.
        var tag = document.createElement('script');

        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // 3. This function creates an <iframe> (and YouTube player)
        //    after the API code downloads.
        var player;
        var now = /*[[${now}]]*/
		
			
		
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '270',
                width: '480',
                videoId: now,
                events: {
                    'onReady': onPlayerReady,
                    //'onStateChange': onPlayerStateChange
                }
            });
        }

        // 4. The API will call this function when the video player is ready.
        function onPlayerReady(event) {
            event.target.playVideo();
        }
		/*]]*/
		
		
		
        // 5. The API calls this function when the player's state changes.
        //    The function indicates that when playing a video (state=1),
        //    the player should play for six seconds and then stop.
        
        /*
        var done = false;

        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING && !done) {
                setTimeout(stopVideo, 6000);
                done = true;
            }
        }

        function stopVideo() {
            player.stopVideo();
        }*/
        
    </script>
    <script th:inline="javascript">
    	/*<![CDATA[*/
    	const body = document.querySelector("body");
		const IMG_NUMBER = 5;
		const now1 = /*[[${now}]]*/
		function paintImage(imgNumber) {
		    const image = new Image();
		    image.src = `https://i.ytimg.com/vi/${now1}/mqdefault.jpg`;
		    image.classList.add("bgImage");
		
		    //append -> 뒤에 추가, prepend -> 맨앞에 추가
		    body.prepend(image)
		}
		
		function generateRandom() {
		    const number = Math.floor(Math.random() * IMG_NUMBER);
		    return number;
		}
		
		
		function init() {
		    const randomNumber = generateRandom();
		    paintImage(randomNumber);
		}
		
		init();
		/*]]*/
    </script>
</body>